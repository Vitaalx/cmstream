<div class="absolute top-0 left-0 w-[calc(100vw-250px)] h-[calc(100vh-100px)] ml-[250px] mt-[100px] flex justify-center items-center bg-[rgba(0,0,0,0.5)] overlay"
>
    <div class="relative w-[400px] h-[280px] px-[48px] py-[24px] flex flex-col justify-center items-center gap-[30px] bg-white rounded-xl popup">
        <span class="my-[-16.5px] text-[60px] text-pinkred mdi mdi-alert-circle-outline"></span>
        <p class="text-center message">Êtes-vous sûr de vouloir supprimer cet utilisateur ?</p>
        <div class="flex gap-[10px] buttons">
            <button @click="this.deleteUser()" class="w-[110px] px-[16px] py-[12px] text-center text-white bg-pinkred hover:bg-pinkredhover rounded-lg">Supprimer</button>
            <button @click="this.closeModal()" class="w-[100px] px-[16px] py-[12px] text-center text-black bg-white hover:bg-whiteless border-solid border-2 border-whiteless rounded-lg">Annuler</button>
        </div>
    </div>
</div>

<script>
    const [impLoader, impTaob] = await Promise.all([
        import("/public/cuteVue/loader.js"),
        import("/public/cuteVue/taob.js")
    ]);
    const loaderStore = impLoader.loaderStore;
    const taob = impTaob.default;

    export default {
        props: {
            userid: ""
        },
        methods: {
            closeModal() {
                this.$emit("close");
            },
            async deleteUser() {
                let close = loaderStore.push();

                await taob.delete("/user/" + this.userid)
                .s(async () => {
                    this.$emit("ondelete", "delete");
                    this.pushToast("successfull", "L'utilisateur à bien été supprimé.");
                })
                .info(info => {
                if(info === "user.cant.delete.admin") this.pushToast("error", "Vous ne pouvez pas supprimer le superadministrateur.");
                }).result;

                this.closeModal();
                close();
            }
        },
        mounted() {

        },
        stores: [
            {
                name: "toast",
                actions: ["pushToast"]
            }
        ]
    }
</script>

<style>

</style>